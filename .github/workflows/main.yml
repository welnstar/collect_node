name: Test Environment Variable

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    environment: daily-config  # â† ä½ çš„ Environment åç§°
    steps:
    - name: Check Environment Variables
      # ğŸ”¥ ä½¿ç”¨ vars. è¯­æ³•å¼•ç”¨ Environment å˜é‡
      env:
        CONFIG_LIST: ${{ vars.CONFIG_LIST }}
      run: |
        echo "ğŸ” Testing Environment Variable Access"
        echo "====================================="
        
        # æ£€æŸ¥æ‰€æœ‰åŒ…å« CONFIG çš„ç¯å¢ƒå˜é‡
        echo "ğŸ“‹ All environment variables containing 'CONFIG':"
        env | grep -i config || echo "âŒ No CONFIG variables found"
        
        echo ""
        # ç›´æ¥è¾“å‡º CONFIG_LIST
        echo "ğŸ“‹ CONFIG_LIST value:"
        echo "----------------------"
        if [[ -z "$CONFIG_LIST" ]]; then
          echo "âŒ CONFIG_LIST is EMPTY!"
          echo "Possible reasons:"
          echo "  1. Environment name in YAML doesn't match GitHub"
          echo "  2. CONFIG_LIST variable doesn't exist in that Environment"
          echo "  3. Variable name is misspelled"
          echo "  4. Current branch doesn't have access to this Environment"
        else
          echo "âœ… CONFIG_LIST has content (length: ${#CONFIG_LIST})"
          echo "$CONFIG_LIST"
          echo "----------------------"
          echo "Number of lines: $(echo "$CONFIG_LIST" | wc -l)"
        fi
        
        echo ""
        # æ£€æŸ¥ Environment ä¿¡æ¯
        echo "ğŸ“‹ Environment Info:"
        echo "GITHUB_ENVIRONMENT: $GITHUB_ENVIRONMENT"
        
        echo ""
        # å°è¯•è§£æä¸ºæ•°ç»„
        if [[ -n "$CONFIG_LIST" ]]; then
          echo "ğŸ“‹ Attempting to parse as array:"
          readarray -t CONFIG_ARRAY <<<"$CONFIG_LIST"
          echo "Array has ${#CONFIG_ARRAY[@]} elements:"
          for i in "${!CONFIG_ARRAY[@]}"; do
            if [[ -n "${CONFIG_ARRAY[$i]}" ]]; then
              echo "  [$i]: [${CONFIG_ARRAY[$i]}]"
            fi
          done
        fi
